<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>libnxter: PID.nxc File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>PID.nxc File Reference</h1>Generic PID controller implementation. <a href="#_details">More...</a>
<p>

<p>
<div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dynsection">
<p><center><img src="_p_i_d_8nxc__dep__incl.png" border="0" usemap="#PID.nxcdep_map" alt=""></center>
<map name="PID.nxcdep_map">
<area shape="rect" href="_sonar_8nxc.html" title="Sonar implementation with an ultrasonic sensor, optionally mounted on a sweep motor..." alt="" coords="24,155,104,181"><area shape="rect" href="_example_8nxc-source.html" title="Example.nxc" alt="" coords="55,229,151,256"><area shape="rect" href="_motor_8nxc.html" title="Motor control implementation." alt="" coords="101,80,181,107"><area shape="rect" href="_vehicle_8nxc.html" title="A simple 2 wheels drive vehicle implementation that can travel a set of navigation..." alt="" coords="179,155,267,181"></map>
</div>

<p>
<a href="_p_i_d_8nxc-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_p_i_d_control.html">PIDControl</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">PID controller class.  <a href="struct_p_i_d_control.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8nxc.html#c07bc7e5f149fb5d9eb75c9ee65b2bbe">PIDControlInit</a> (<a class="el" href="struct_p_i_d_control.html">PIDControl</a> &amp;pidControl, long PIDScale, long PValue, long IValue, long DValue, int steadyStateCountThreshold, long outputGain, long absMaxOutput)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initializes a PID controller with the given P, I and D values, output parameters.  <a href="#c07bc7e5f149fb5d9eb75c9ee65b2bbe"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a656a7e785e6321a630ddbf51bab67fc"></a><!-- doxytag: member="PID.nxc::PIDControlSetIntegralLimit" ref="a656a7e785e6321a630ddbf51bab67fc" args="(PIDControl &amp;pidControl, long absIntegralLimit)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8nxc.html#a656a7e785e6321a630ddbf51bab67fc">PIDControlSetIntegralLimit</a> (<a class="el" href="struct_p_i_d_control.html">PIDControl</a> &amp;pidControl, long absIntegralLimit)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets integral output absolute maximum used to prevent integral windup. The default is set to absMaxOutput. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ce86e59ae942eba8c1cb4041a31672e8"></a><!-- doxytag: member="PID.nxc::PIDControlSetPoint" ref="ce86e59ae942eba8c1cb4041a31672e8" args="(PIDControl &amp;pidControl, long setPoint)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8nxc.html#ce86e59ae942eba8c1cb4041a31672e8">PIDControlSetPoint</a> (<a class="el" href="struct_p_i_d_control.html">PIDControl</a> &amp;pidControl, long setPoint)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets a new set point for the controller. The controller state is reset and the new target is pursued. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8nxc.html#e0e4382050acdcb5093f91bc05fdc599">PIDControlCheckEnd</a> (<a class="el" href="struct_p_i_d_control.html">PIDControl</a> &amp;pidControl)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks if the PID controller has ended.  <a href="#e0e4382050acdcb5093f91bc05fdc599"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="54b84dc361031ddb3f98dbc071aebb28"></a><!-- doxytag: member="PID.nxc::PIDControlGetLastError" ref="54b84dc361031ddb3f98dbc071aebb28" args="(PIDControl &amp;pidControl)" -->
long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8nxc.html#54b84dc361031ddb3f98dbc071aebb28">PIDControlGetLastError</a> (<a class="el" href="struct_p_i_d_control.html">PIDControl</a> &amp;pidControl)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets the error from the last step. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0734cd5792dd2b2a72ad516342998551"></a><!-- doxytag: member="PID.nxc::PIDControlStep" ref="0734cd5792dd2b2a72ad516342998551" args="(PIDControl &amp;pidControl, long currentPoint)" -->
long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8nxc.html#0734cd5792dd2b2a72ad516342998551">PIDControlStep</a> (<a class="el" href="struct_p_i_d_control.html">PIDControl</a> &amp;pidControl, long currentPoint)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Steps the PID controller. currentPoint is the current state of the system. The return value is the output of the controller that should be applied to the input of the system (e.g. motor). Call this method in regular (sampling) period. <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Generic PID controller implementation. 
<p>

<p>Definition in file <a class="el" href="_p_i_d_8nxc-source.html">PID.nxc</a>.</p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="e0e4382050acdcb5093f91bc05fdc599"></a><!-- doxytag: member="PID.nxc::PIDControlCheckEnd" ref="e0e4382050acdcb5093f91bc05fdc599" args="(PIDControl &amp;pidControl)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PIDControlCheckEnd           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_p_i_d_control.html">PIDControl</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>pidControl</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checks if the PID controller has ended. 
<p>
PID controller ends if it has settled at set point for steadyStateCountThreshold steps, or it is not changing that steadyStateCountThreshold many steps (usually because of system overload and therefore ending is good). When the controller is ended it only outputs 0. If the controller is running in continous mode, i.e. steadyStateCountThreshold = 0, this method always return false. 
<p>Definition at line <a class="el" href="_p_i_d_8nxc-source.html#l00120">120</a> of file <a class="el" href="_p_i_d_8nxc-source.html">PID.nxc</a>.</p>

<p>References <a class="el" href="_p_i_d_8nxc-source.html#l00051">PIDControl::steadyStateCount</a>, and <a class="el" href="_p_i_d_8nxc-source.html#l00039">PIDControl::steadyStateCountThreshold</a>.</p>

<p>Referenced by <a class="el" href="_motor_8nxc-source.html#l00135">MotorRotateAngle()</a>, <a class="el" href="_motor_8nxc-source.html#l00211">MotorRotateAngleDiff()</a>, <a class="el" href="_motor_8nxc-source.html#l00173">MotorRotateAngleSync()</a>, <a class="el" href="_p_i_d_8nxc-source.html#l00142">PIDControlStep()</a>, and <a class="el" href="_sonar_8nxc-source.html#l00189">SonarSweep()</a>.</p>

</div>
</div><p>
<a class="anchor" name="c07bc7e5f149fb5d9eb75c9ee65b2bbe"></a><!-- doxytag: member="PID.nxc::PIDControlInit" ref="c07bc7e5f149fb5d9eb75c9ee65b2bbe" args="(PIDControl &amp;pidControl, long PIDScale, long PValue, long IValue, long DValue, int steadyStateCountThreshold, long outputGain, long absMaxOutput)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PIDControlInit           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_p_i_d_control.html">PIDControl</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>pidControl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>PIDScale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>PValue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>IValue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>DValue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>steadyStateCountThreshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>outputGain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>absMaxOutput</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initializes a PID controller with the given P, I and D values, output parameters. 
<p>
The P, I and D parameters are normally fractions and to accomodate them in integer form, they should be scaled by a number. The scale value is given as PIDScale (1000 is a good choice). If error does not change for 'steadyStateCountThreshold' many steps, the control is ended. It could be either because the system state has settled (error stays at 0) or it is stuck, in which case it is usually good to end to avoid overloading. If steadyStateCountThreshold is given as '0', the PID controller runs in continous mode and the control never ends. When running PIDController in continous mode, keep setting new set points with <a class="el" href="_p_i_d_8nxc.html#ce86e59ae942eba8c1cb4041a31672e8" title="Sets a new set point for the controller. The controller state is reset and the new...">PIDControlSetPoint()</a> as needed. outputGain is the multiplying factor to current PID output to get actual output. The output is clipped, both positive side and negative side, at the absolute value absMaxOutput. 
<p>Definition at line <a class="el" href="_p_i_d_8nxc-source.html#l00071">71</a> of file <a class="el" href="_p_i_d_8nxc-source.html">PID.nxc</a>.</p>

<p>References <a class="el" href="_p_i_d_8nxc-source.html#l00046">PIDControl::absIntegralLimit</a>, <a class="el" href="_p_i_d_8nxc-source.html#l00045">PIDControl::absMaxOutput</a>, <a class="el" href="_p_i_d_8nxc-source.html#l00037">PIDControl::DValue</a>, <a class="el" href="_p_i_d_8nxc-source.html#l00049">PIDControl::integral</a>, <a class="el" href="_p_i_d_8nxc-source.html#l00036">PIDControl::IValue</a>, <a class="el" href="_p_i_d_8nxc-source.html#l00050">PIDControl::lastError</a>, <a class="el" href="_p_i_d_8nxc-source.html#l00044">PIDControl::outputGain</a>, <a class="el" href="_p_i_d_8nxc-source.html#l00034">PIDControl::PIDScale</a>, <a class="el" href="_p_i_d_8nxc-source.html#l00035">PIDControl::PValue</a>, <a class="el" href="_p_i_d_8nxc-source.html#l00038">PIDControl::setPoint</a>, <a class="el" href="_p_i_d_8nxc-source.html#l00051">PIDControl::steadyStateCount</a>, and <a class="el" href="_p_i_d_8nxc-source.html#l00039">PIDControl::steadyStateCountThreshold</a>.</p>

<p>Referenced by <a class="el" href="_motor_8nxc-source.html#l00135">MotorRotateAngle()</a>, <a class="el" href="_motor_8nxc-source.html#l00211">MotorRotateAngleDiff()</a>, <a class="el" href="_motor_8nxc-source.html#l00173">MotorRotateAngleSync()</a>, and <a class="el" href="_sonar_8nxc-source.html#l00087">SonarInit()</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Jun 6 15:09:09 2009 for libnxter by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
